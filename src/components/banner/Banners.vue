<template>
  <div>
    <v-skeleton-loader
      v-if="loading"
      type="image"
      height="400"
    />

    <v-carousel
      v-else
      cycle
      hide-delimiter-background
      height="400"
    >
      <v-carousel-item
        v-for="(image, index) in allImages"
        :key="index"
        :src="getImageUrl(image)"
        cover
      />
    </v-carousel>
  </div>
</template>

<script setup>
import { ref, onMounted } from "vue";
import axios from "axios";

const allImages = ref([]);
const loading = ref(true);

onMounted(async () => {
  try {
    const response = await axios.get("https://ftrip.tech/api1/api/banners");
    // Assuming your API returns an array of objects, each with an "images" array
    allImages.value = response.data.data.flatMap(item => item.images);
  } catch (error) {
    console.error("Error fetching banners:", error);
  } finally {
    loading.value = false;
  }
});

// âœ… Corrected URL (no /api1/)
const getImageUrl = (path) => {
  if (!path) return '/image/no-image.png';
  // Make sure 'path' already includes 'banners/' part if needed
  return `https://ftrip.tech/storage/${path}`;
};
</script>
